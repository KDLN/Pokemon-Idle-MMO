---
phase: 18-component-updates
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/web/src/components/game/social/ChatMessage.tsx
  - apps/web/src/components/game/social/ChatInput.tsx
  - apps/web/src/components/game/social/ChatSidebar.tsx
  - apps/web/src/components/game/GameShell.tsx
  - apps/web/src/app/globals.css
autonomous: true

must_haves:
  truths:
    - "Chat messages have rounded bubble backgrounds"
    - "Username colors are role-based (guild master=gold, officers=distinct, members=another)"
    - "Chat tabs have underline accent in brand color"
    - "Send button uses BeveledButton component"
    - "Notification badges are red pills with white numbers"
    - "Timestamps use absolute format (12:34 PM)"
  artifacts:
    - path: "apps/web/src/components/game/social/ChatMessage.tsx"
      provides: "Chat message with role-based colors"
      contains: "leader.*gold|yellow"
    - path: "apps/web/src/components/game/social/ChatInput.tsx"
      provides: "Chat input with BeveledButton"
      contains: "BeveledButton"
    - path: "apps/web/src/components/game/GameShell.tsx"
      provides: "Social tabs with underline accent"
      contains: "border-b-2"
  key_links:
    - from: "ChatInput.tsx"
      to: "BeveledButton"
      via: "import from Button component"
      pattern: "from.*Button"
    - from: "ChatMessage.tsx"
      to: "formatTime"
      via: "absolute time formatting"
      pattern: "hour12.*true"
---

<objective>
Apply Mock styling to social area and finalize mobile tab bar

Purpose: Complete component migration - chat styling and mobile polish
Output: Social sidebar styled to match Mock, mobile experience polished
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/STATE.md
@.planning/phases/18-component-updates/18-CONTEXT.md
@.planning/phases/18-component-updates/18-RESEARCH.md
@.planning/intel/summary.md
@apps/web/src/components/game/MockGameScreen.tsx
@apps/web/src/components/game/social/ChatMessage.tsx
@apps/web/src/components/game/social/ChatInput.tsx
@apps/web/src/components/game/social/ChatSidebar.tsx
@apps/web/src/components/game/GameShell.tsx
@apps/web/src/app/globals.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Style chat messages with role-based colors and bubbles</name>
  <files>apps/web/src/components/game/social/ChatMessage.tsx</files>
  <action>
Update ChatMessage to match MockSocialSidebar chat styling (lines 650-671):

1. Role-based username colors per CONTEXT.md:
- Guild master (leader): gold/yellow - text-yellow-400 or text-[var(--color-brand-accent)]
- Officers: blue - text-blue-400 or text-[var(--color-brand-primary)]
- Members: gray/muted - text-[var(--color-text-secondary)]
- Non-guild (global chat): white - text-white

Update getRoleBadge or create getUsernameColor function:
```typescript
function getUsernameColor(role?: GuildRole, channel?: ChatChannel): string {
  if (role === 'leader') return 'text-yellow-400'
  if (role === 'officer') return 'text-blue-400'
  if (role === 'member') return 'text-purple-400'
  // Default based on channel
  if (channel === 'trade') return 'text-green-400'
  if (channel === 'whisper') return 'text-pink-400'
  return 'text-white'
}
```

2. Message bubble styling (rounded backgrounds):
```tsx
<div className={`
  chat-message text-sm rounded-lg px-2 py-1
  ${isOwnMessage ? 'bg-[#252542]' : 'bg-[var(--color-surface-base)]'}
`}>
```

3. Timestamps - already using absolute format via formatTime. Verify it produces "12:34 PM" format.
Current code looks correct with hour12: true.

4. Message content styling:
- text-xs for message text
- break-words for long messages
- Color: text-[var(--color-text-secondary)] or text-[#e0e0e0]

5. Keep existing features:
- ClickableUsername component (for player action modal)
- Whisper styling (purple border-left, different background)
- System message styling
- Role badge (L/O/M) for guild chat
  </action>
  <verify>
Chat messages show:
- Guild masters have gold/yellow usernames
- Officers have blue usernames
- Members have purple usernames
- Messages have rounded bubble backgrounds
- Timestamps in "12:34 PM" format
- Whispers have purple accent styling
  </verify>
  <done>Chat messages have role-based username colors and bubble styling</done>
</task>

<task type="auto">
  <name>Task 2: Update ChatInput with BeveledButton and social tabs</name>
  <files>apps/web/src/components/game/social/ChatInput.tsx, apps/web/src/components/game/GameShell.tsx</files>
  <action>
Update ChatInput to use BeveledButton (per CONTEXT.md and Phase 17):

1. Import BeveledButton:
```typescript
import { BeveledButton } from '@/components/ui/Button'
```

2. Replace current send button with BeveledButton:
Current:
```tsx
<button className="px-4 py-2 rounded-lg text-sm font-medium...">
  Send
</button>
```

Becomes:
```tsx
<BeveledButton
  hue={240}           // Blue hue (Claude's discretion - brand primary)
  saturation={60}
  lightness={45}
  onClick={handleSend}
  disabled={disabled || isSystemChannel || !message.trim()}
  className="px-4 py-2"
>
  Send
</BeveledButton>
```

3. Keep input-inset styling (already applied in Phase 17-03).

4. Update SocialSidebar in GameShell.tsx for tab underline accent:
Current tabs have `active` class. Update to add brand-color underline:
```tsx
<button
  className={`stab ${tab === 'chat' ? 'active' : ''}`}
  // In CSS, .stab.active should have:
  // border-b-2 border-[var(--color-brand-primary)]
>
```

Or inline:
```tsx
<button
  className={cn(
    "stab",
    tab === 'chat' && "text-[var(--color-text-primary)] border-b-2 border-[var(--color-brand-primary)]"
  )}
>
```

5. Update notification badges to be red pills:
The badges already exist (.trade-count class). Verify they match Mock:
- Red background: bg-[var(--color-brand-secondary)] or bg-red-500
- White text
- Rounded pill shape: rounded-full or rounded
- Small padding: px-1 py-0.5
- Font size: text-[9px] or text-xs
  </action>
  <verify>
ChatInput shows:
- BeveledButton for Send (blue hue)
- Input still has inset styling

Social tabs show:
- Active tab has underline in brand color
- Notification badges are red pills with white numbers
  </verify>
  <done>ChatInput uses BeveledButton; social tabs have underline accent and red pill badges</done>
</task>

<task type="auto">
  <name>Task 3: Polish mobile tab bar for native feel</name>
  <files>apps/web/src/components/game/GameShell.tsx, apps/web/src/app/globals.css</files>
  <action>
Review and polish mobile tab bar (MobileTabBar in GameShell.tsx, lines 388-434):

1. Verify tab labels match CONTEXT.md decision:
   Zone / Party / Social / Map (four tabs)

Current tabs are: Map / Game / Party / Social
Update to: Zone / Party / Social / Map

```tsx
<button onClick={() => onTabChange('game')}>
  <span className="tab-icon">üó∫Ô∏è</span>
  <span>Zone</span>
</button>
<button onClick={() => onTabChange('party')}>
  <span className="tab-icon">‚öîÔ∏è</span>
  <span>Party</span>
</button>
<button onClick={() => onTabChange('social')}>
  <span className="tab-icon">üí¨</span>
  <span>Social</span>
</button>
<button onClick={() => onTabChange('map')}>
  <span className="tab-icon">üéÆ</span>
  <span>Map</span>
</button>
```

Wait, looking at current code:
- 'map' -> Map tab
- 'game' -> Game tab (shows WorldView)
- 'party' -> Party tab
- 'social' -> Social tab

Rename for clarity:
- 'game' tab shows zone view, so label should be "Zone"
- 'map' tab shows MapSidebar, label is "Map"
- Keep party and social labels

2. Review CSS in globals.css for mobile-tab-bar (lines 2609-2673):
- Already has fixed bottom position
- Already has safe-area-inset-bottom
- Already has .tab-badge styling

3. Polish active state:
Current: `color: var(--lb-accent)` for active
Add underline or background highlight for more prominent active indicator:
```css
.mobile-tab-bar button.active {
  color: var(--color-brand-primary);
  position: relative;
}

.mobile-tab-bar button.active::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 20%;
  right: 20%;
  height: 2px;
  background: var(--color-brand-primary);
  border-radius: 1px;
}
```

4. Ensure badge pill on Social tab uses red background with white text per Mock pattern.
Current .tab-badge has `background: var(--lb-red)` which is correct.
  </action>
  <verify>
Mobile tab bar shows:
- Four tabs: Zone / Party / Social / Map
- Active tab has visual indicator (color + underline)
- Badge on Social tab is red pill
- Safe area insets work on notched devices (test on iOS simulator or device if available)
- Tab bar is fixed at bottom
  </verify>
  <done>Mobile tab bar has correct labels, active indicator, and native feel</done>
</task>

</tasks>

<verification>
- Chat messages have role-based username colors
- Chat bubbles have rounded backgrounds
- Send button is BeveledButton
- Social tabs have underline accent for active state
- Notification badges are red pills
- Mobile tab bar has Zone/Party/Social/Map labels
- Mobile active tab has visual indicator
- All chat functionality preserved (commands, whispers, muting)
</verification>

<success_criteria>
- Social area matches MockSocialSidebar styling
- BeveledButton used for Send action
- Role hierarchy visible through username colors
- Mobile tab bar feels native with correct labels
- No chat features broken (commands, whispers, block/mute)
</success_criteria>

<output>
After completion, create `.planning/phases/18-component-updates/18-03-SUMMARY.md`
</output>
