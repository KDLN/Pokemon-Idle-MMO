---
phase: 18-component-updates
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/web/src/components/game/world/WorldView.tsx
  - apps/web/src/components/game/world/BackgroundLayer.tsx
  - apps/web/src/components/game/world/TimeOfDayOverlay.tsx
  - apps/web/src/components/game/PokemonCard.tsx
  - apps/web/src/components/game/PartyPanel.tsx
autonomous: true

must_haves:
  truths:
    - "Zone view shows centered 'Exploring...' text with pixel font"
    - "Zone view has zone-specific gradient backgrounds"
    - "Time-of-day sky system shows 4 periods (dawn, day, dusk, night)"
    - "Pokemon cards have type-colored background (20% opacity) AND colored border"
    - "Pokemon cards show sprite scale (110%) on hover"
    - "Towns have ambient particles (different style than routes)"
  artifacts:
    - path: "apps/web/src/components/game/world/WorldView.tsx"
      provides: "Zone view with centered text overlay"
      contains: "Exploring..."
    - path: "apps/web/src/components/game/world/TimeOfDayOverlay.tsx"
      provides: "Time-of-day sky gradients"
      contains: "dawn|day|dusk|night"
    - path: "apps/web/src/components/game/PokemonCard.tsx"
      provides: "Pokemon card with type styling"
      contains: "opacity-20"
  key_links:
    - from: "WorldView.tsx"
      to: "BackgroundLayer.tsx"
      via: "zone type prop"
      pattern: "zoneType"
    - from: "PokemonCard.tsx"
      to: "getSpeciesData"
      via: "type color lookup"
      pattern: "speciesData.color"
---

<objective>
Apply Mock styling to zone view and party panel components

Purpose: Update main game content area - zone atmosphere and party card visuals
Output: WorldView with atmosphere effects, PokemonCard with enhanced type styling
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/STATE.md
@.planning/phases/18-component-updates/18-CONTEXT.md
@.planning/phases/18-component-updates/18-RESEARCH.md
@.planning/intel/summary.md
@apps/web/src/components/game/MockGameScreen.tsx
@apps/web/src/components/game/world/WorldView.tsx
@apps/web/src/components/game/world/BackgroundLayer.tsx
@apps/web/src/components/game/world/TimeOfDayOverlay.tsx
@apps/web/src/components/game/PokemonCard.tsx
@apps/web/src/components/game/PartyPanel.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add centered text overlay and zone gradients to WorldView</name>
  <files>apps/web/src/components/game/world/WorldView.tsx, apps/web/src/components/game/world/BackgroundLayer.tsx</files>
  <action>
Update WorldView to add centered text overlay matching MockWorldView (lines 371-413):

1. Add centered content overlay (on top of existing trainer/pokemon):
```tsx
{/* Center content - "Exploring..." overlay */}
<div className="absolute inset-0 flex flex-col items-center justify-center pointer-events-none">
  <div className="text-center">
    <div className="font-pixel text-sm text-[var(--color-text-primary)] mb-2">
      {isRoute ? 'Exploring...' : 'In Town'}
    </div>
    <div className="text-[var(--color-text-secondary)] text-sm mb-1">
      {currentZone?.name}
    </div>
    {isRoute && (
      <div className="text-[10px] text-[var(--color-text-muted)]">
        Wild Pokemon may appear!
      </div>
    )}
  </div>
</div>
```

2. Update container classes to match Mock:
- texture-noise h-full relative rounded-xl overflow-hidden
- Remove poke-border, use border border-[var(--color-border-subtle)]

3. Update BackgroundLayer.tsx to support zone-specific gradients:
- Forest zones: bg-gradient-to-b from-[#2a3a2a] to-[#1a2a1a] (green tones)
- Cave zones: bg-gradient-to-b from-[#2a2a3a] to-[#1a1a2a] (dark gray/purple)
- Water zones: bg-gradient-to-b from-[#2a3a4a] to-[#1a2a3a] (blue tones)
- Route zones: existing grass gradient
- Town zones: bg-gradient-to-b from-[#2a2a3a] to-[#1a1a2a] (neutral)

4. Add sky gradient overlay at top (like Mock):
```tsx
<div className="absolute inset-0 bg-gradient-to-b from-sky-900/30 via-transparent to-transparent" />
```

5. Add floor gradient at bottom for forests:
```tsx
{zoneType === 'forest' && (
  <div className="absolute bottom-0 left-0 right-0 h-32 bg-gradient-to-t from-green-900/40 to-transparent" />
)}
```

Keep existing trainer sprite, pokemon companion, time display, zone info - they should coexist with the overlay.
  </action>
  <verify>
Zone view shows:
- "Exploring..." or "In Town" text centered in pixel font
- Zone name below the status text
- Sky gradient visible at top
- Forest floor gradient on forest zones
- Existing trainer/pokemon sprites still visible
  </verify>
  <done>WorldView has centered text overlay and zone-specific gradient backgrounds</done>
</task>

<task type="auto">
  <name>Task 2: Implement 4-period time-of-day sky system</name>
  <files>apps/web/src/components/game/world/TimeOfDayOverlay.tsx, apps/web/src/lib/time/timeOfDay.ts</files>
  <action>
Update TimeOfDayOverlay to implement 4-period sky system per CONTEXT.md:

1. Define sky gradients for each period:
- **Dawn** (5:00-8:00): Orange/pink tones
  `from-orange-900/40 via-pink-900/20 to-transparent`
- **Day** (8:00-17:00): Blue sky tones
  `from-sky-900/30 via-transparent to-transparent`
- **Dusk** (17:00-20:00): Orange/purple tones
  `from-orange-900/40 via-purple-900/20 to-transparent`
- **Night** (20:00-5:00): Dark blue/purple
  `from-indigo-950/60 via-purple-950/30 to-transparent`

2. Update timeOfDay.ts if needed to support 4 periods:
```typescript
export type TimeOfDay = 'dawn' | 'day' | 'dusk' | 'night'

export function getTimeOfDay(): TimeOfDay {
  const hour = new Date().getHours()
  if (hour >= 5 && hour < 8) return 'dawn'
  if (hour >= 8 && hour < 17) return 'day'
  if (hour >= 17 && hour < 20) return 'dusk'
  return 'night'
}
```

3. Update TimeOfDayOverlay component:
```tsx
const SKY_GRADIENTS: Record<TimeOfDay, string> = {
  dawn: 'from-orange-900/40 via-pink-900/20 to-transparent',
  day: 'from-sky-900/30 via-transparent to-transparent',
  dusk: 'from-orange-900/40 via-purple-900/20 to-transparent',
  night: 'from-indigo-950/60 via-purple-950/30 to-transparent',
}

export function TimeOfDayOverlay() {
  const timeOfDay = getTimeOfDay()
  return (
    <div className={`absolute inset-0 bg-gradient-to-b ${SKY_GRADIENTS[timeOfDay]} pointer-events-none transition-colors duration-1000`} />
  )
}
```

4. Time system uses server/game time so all players see the same sky (shared world feeling).
  </action>
  <verify>
Time-of-day overlay shows:
- Orange/pink gradient during dawn hours (5-8 AM)
- Blue sky gradient during day (8 AM - 5 PM)
- Orange/purple gradient during dusk (5-8 PM)
- Dark blue/purple gradient during night (8 PM - 5 AM)
  </verify>
  <done>Time-of-day sky system implements 4 periods with appropriate gradients</done>
</task>

<task type="auto">
  <name>Task 3: Update PokemonCard with Mock styling and town particles</name>
  <files>apps/web/src/components/game/PokemonCard.tsx, apps/web/src/components/game/world/WorldView.tsx</files>
  <action>
Update PokemonCard to match MockPokemonCard styling (lines 416-478):

1. Type-colored background overlay (20% opacity):
The card already has this. Verify opacity is 20% (opacity-20 class).

2. Type-colored border:
The card already uses getTypeBorderClass which provides border-l-4 with type color.
Ensure the full border also has type tint:
```tsx
style={{
  borderLeftColor: isShiny ? '#FFD700' : speciesData.color,
  borderColor: `${speciesData.color}40` // 25% opacity for subtle type tint on all borders
}}
```

3. Hover effects - both card lift AND sprite scale:
- Card already has hover:scale-[1.02]
- Sprite already has group-hover:scale-110

4. Verify HP bar color logic:
- Low HP (<30%): bg-[var(--color-error)]
- Medium HP (30-50%): bg-[var(--color-warning)]
- Full HP (>50%): bg-[var(--color-success)]

5. Add town particles to WorldView (different style than routes):
Per CONTEXT.md, towns should have ambient particles but different style (Claude's discretion: golden sparkles for a more settled/magical feel).

In WorldView.tsx, add for towns:
```tsx
{zoneType === 'town' && (
  <>
    <div className="absolute top-8 left-12 w-1 h-1 rounded-full bg-yellow-300/40 animate-pulse" aria-hidden="true" />
    <div className="absolute top-16 right-16 w-1.5 h-1.5 rounded-full bg-amber-300/30 animate-pulse" aria-hidden="true" />
    <div className="absolute bottom-20 left-20 w-1 h-1 rounded-full bg-yellow-200/35 animate-pulse" aria-hidden="true" />
  </>
)}
```

Keep existing production features:
- Drag-and-drop via SortablePokemonCard
- Remove button on hover
- Potion button for low HP
- IV grade badges
- Shiny effects
  </action>
  <verify>
Pokemon cards show:
- Type-colored background with 20% opacity
- Type-colored border (left border + subtle tint on other sides)
- Sprite scales to 110% on hover
- Card lifts slightly on hover
- HP bar colors correctly based on percentage

Towns show:
- Golden/amber ambient particles (different from route green particles)
  </verify>
  <done>PokemonCard has Mock styling with type colors, hover effects; towns have golden particles</done>
</task>

</tasks>

<verification>
- Zone view shows centered "Exploring..." text with pixel font
- Zone backgrounds change based on zone type (forest=green, cave=dark, etc.)
- Time-of-day overlay transitions through 4 periods
- Pokemon cards have type-colored backgrounds (20% opacity) and borders
- Card sprites scale on hover, cards lift slightly
- Towns have golden ambient particles
- All existing functionality preserved (drag, remove, potion, etc.)
</verification>

<success_criteria>
- WorldView matches MockWorldView atmosphere and text overlay
- TimeOfDayOverlay implements 4-period system
- PokemonCard styling matches Mock pattern
- Routes have green particles, towns have golden particles
- No drag-and-drop or interactive features broken
</success_criteria>

<output>
After completion, create `.planning/phases/18-component-updates/18-02-SUMMARY.md`
</output>
